A = array(double, [13, 13])
u = array(double, [13, 13, 13])
D = array(double, [13, 13, 13])


At = vtranspose(A, [[1, 2]])
tmp1 = contract(At, u, [[2, 1]])
tmp2 = contract(At, tmp1, [[2, 2]])
tmp3 = contract(At, tmp2, [[2, 3]])
tmp4 = entrywise_mul(D, tmp3)
tmp5 = contract(A, tmp4, [[2, 1]])
tmp6 = contract(A, tmp5, [[2, 2]])
v = contract(A, tmp6, [[2, 3]])


l1 = build(tmp1)
l2 = build(tmp2)
l3 = build(tmp3)
l4 = build(tmp4)
l5 = build(tmp5)
l6 = build(tmp6)
lv = build(v)

init(A, 1)
init(D, 1)
init(u, 1)
init(tmp1, 0)
init(tmp2, 0)
init(tmp3, 0)
init(tmp4, 0)
init(tmp5, 0)
init(tmp6, 0)
init(v, 0)
codegen([l1, l2, l3, l4, l5, l6, lv])
